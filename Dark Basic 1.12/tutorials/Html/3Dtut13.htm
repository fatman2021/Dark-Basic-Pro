<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="Generator" content="Microsoft Word 97">
   <meta name="GENERATOR" content="Microsoft FrontPage 4.0">
   <title>3Dtut1</title>
</head>
<body text="#FFFFFF" link="#FFFF00" vlink="#00FF00" background="dbback.gif" BGPROPERTIES="FIXED">
<font face="Arial,Helvetica"><font color="#FFFF00"><font size=+3>3D
Tutorials: 3. The Game</font></font></font>
<br><font face="Arial,Helvetica"><font color="#FFFF00"><font size=+2>2.
Mouse look</font></font></font>
<p><font face="Arial,Helvetica"><font color="#FFFF00"><font size=+1>Purpose:
To explain how to use the mouse commands to move the camera.</font></font></font>
<p><font face="Arial,Helvetica"><font size=+1>"Mouse look" is a feature
you have seen in many games. This feature allows you to move your mouse
to manipulate the camera like you would moving your head. It's a technique
that is more efficient for changing your view than manipulating the camera
with the keyboard.</font></font>
<p><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>Sync
On</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>Sync
Rate 30</font></font></font>
<p><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>hide
mouse</font></font></font>
<p><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>Backdrop
on</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>Set
camera range 1,5000</font></font></font>
<p><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>Fog
on</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>Fog
distance 4000</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>Fog
color RGB(128,128,128)</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>Color
Backdrop RGB(128,128,128)</font></font></font>
<p><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>Rem
make matrix</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>Make
matrix 1,10000,10000,20,20</font></font></font>
<p><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>Rem
texture matrix</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>Load
image "grass09.bmp",1</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>Prepare
matrix texture 1,1,1,1</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>Fill
matrix 1,0,1</font></font></font>
<p><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>rem
Randomize the matrix</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>randomize
matrix 1,125</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>X#=5000</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>Z#=5000</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>Rem
Main loop</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>Do</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;OldCamAngleY#
= CameraAngleY#</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;OldCamAngleX#
= CameraAngleX#</font></font></font>
<p><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;CameraAngleY#
= WrapValue(CameraAngleY#+MousemoveX()*0.2)</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;CameraAngleX#
= WrapValue(CameraAngleX#+MousemoveY()*0.2)</font></font></font>
<p><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;Rem&nbsp;
Control input for camera</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;If
Upkey()=1</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;
XTest# = Newxvalue(X#,CameraAngleY#,10)</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;
ZTest# = Newzvalue(Z#,CameraAngleY#,10)</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;
If XTest#>0 and XTest#&lt;10000 and ZTest#>0 and ZTest#&lt;10000</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;&nbsp;
X#=XTest#</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;&nbsp;
Z#=ZTest#</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;
Endif</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;Endif</font></font></font>
<p><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;If
Downkey()=1</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;
XTest# = Newxvalue(X#,Wrapvalue(CameraAngleY#-180),10)</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;
ZTest# = Newzvalue(Z#,Wrapvalue(CameraAngleY#-180),10)</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;
If XTest#>0 and XTest#&lt;10000 and ZTest#>0 and ZTest#&lt;10000</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;&nbsp;
X#=XTest#</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;&nbsp;
Z#=ZTest#</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;
Endif</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;Endif</font></font></font>
<br>&nbsp;
<p><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;Yrotate
camera CurveAngle(CameraAngleY#,OldCamAngleY#,24)</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;Xrotate
camera CurveAngle(CameraAngleX#,OldCamAngleX#,24)</font></font></font>
<br>&nbsp;
<p><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;Y#
= Get ground height(1,X#,Z#)</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;Position
Camera X#,Y#+50,Z#</font></font></font>
<p><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;Rem
Refresh Screen</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;Sync</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>Loop</font></font></font>
<p><font face="Arial,Helvetica"><font size=+1>You'll notice we are using
the same code from the previous tutorial. As we progress throught the following
tutorials we will continue to build on this code to actually create a playable
game.</font></font>
<p><font size=+1>&nbsp;OldCamAngleY#
= CameraAngleY#</font>
<br><font size=+1>&nbsp;OldCamAngleX#
= CameraAngleX#</font>
<br><font size=+1>&nbsp;CameraAngleY# = WrapValue(CameraAngleY#+MousemoveX()*0.2)</font>
<br><font size=+1>&nbsp;CameraAngleX#
= WrapValue(CameraAngleX#+MousemoveY()*0.2)</font>
<br>&nbsp;
<p><font face="Arial,Helvetica"><font size=+1>At this point in our main
loop we are storing the Y and X axis angle rotations&nbsp; of our camera
in the "OldCamAngle" variables. After these values are stored we continue
by assigning the new values to the "CameraAngle" variables. We are using
the "WrapValue" command to keep our angle within the 360 degree bounds.
To change the value of the "CameraAngle" variables, we add the value returned
by the "MouseMove" commands, multiplied by an adjustment value of "0.2".
The "MouseMoveX" and MouseMoveY()" commands return the number of units
the mouse has moved since the last time the mouse was checked for movement.
If you move the mouse very fast up, down, left or right the value returned
will be much greater than it would if you moved it very slowly. The value
is based on the display size of your program is using. Moving the mouse
at a moderate speed usually returns a value between 8 and 16. If the raw
numbers are added to the camera angles, your camera rotation would be to
great to be useful. To normalize this value we are multiplying the value
by 0.2 this will create a value that is a more acceptable rotation.</font></font>
<p><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;Yrotate
camera CurveAngle(CameraAngleY#,OldCamAngleY#,24)</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;Xrotate
camera CurveAngle(CameraAngleX#,OldCamAngleX#,24)</font></font></font>
<br>&nbsp;
<p><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;Y#
= Get ground height(1,X#,Z#)</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;Position
Camera X#,Y#+50,Z#</font></font></font>
<p><font face="Arial,Helvetica"><font size=+1>After processing all of the
input from the keyboard and the mouse commands we rotate the camera using
the camera rotation commands. We use the "CurveAngle" command to create
a smooth transition between the old camera angle and the intended camera
angle. The first parameter in this command is the new angle we wish to
rotate the camera. The second parameter is the current camera angle. The
third parameter is the speed at which we wish to rotate from the old to
the new value. The "CurveAngle" command changes the value based on a curve
so the value used to rotate is somewhere between the old and new value.</font></font>
<p><font face="Arial,Helvetica"><font size=+1>For an interesting camera
effect try changing these two line of code,</font></font>
<p><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;OldCamAngleY#
= CameraAngleY#</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;OldCamAngleX#
= CameraAngleX#</font></font></font>
<p><font face="Arial,Helvetica"><font size=+1>to,</font></font>
<p><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;OldCamAngleY#
= Camera Angle Y()</font></font></font>
<br><font face="Courier New,Courier"><font color="#FFFF00"><font size=+1>&nbsp;OldCamAngleX#
= Camera Angle X()</font></font></font>
<p><font face="Arial,Helvetica"><font size=+1>using the "Camera Angle"
commands.</font></font>
<br>&nbsp;
<br>&nbsp;
<br>&nbsp;
</body>
</html>
